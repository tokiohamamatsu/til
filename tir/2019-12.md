# 2019-12

## [おれがコンピュータに筆算を教えてやる \- 「100 桁の足し算」編 \- Qiita](https://qiita.com/noritakaIzumi/items/7b95852c3d5cc626c7b7)

普通に100桁の足し算をすると結果的にfloat型の値が出て、正確に出てこない

コンピューターに筆算させる

```php
function addBigInt(string $a, string $b): string
{
    // 自然数を受け取る
    $reversedDigit1 = array_reverse(str_split($a));
    $reversedDigit2 = array_reverse(str_split($b));
    $reversedSumDigit = array_fill(
        0,
        /* 足す数のうち，大きい方の桁数 */ max(count($reversedDigit1), count($reversedDigit2)),
        /* 0 で埋めた配列 */ 0
    );


    // 各位の足し算をする
    $carryOver = 0; // 繰り上がりの数字 (2 つの数の足し算なら必ず 0 or 1)
    foreach ($reversedSumDigit as $power => $digit) {
        // 直接要素をいじりたいので， $reversedSumDigit[$power] を変数化しない
        $reversedSumDigit[$power] += $carryOver;
        $carryOver = 0;

        $reversedSumDigit[$power] += $reversedDigit1[$power] + $reversedDigit2[$power];
        if ($reversedSumDigit[$power] >= 10) {
            $carryOver += floor($reversedSumDigit[$power] / 10);
            $reversedSumDigit[$power] %= 10;
        }
    }

    // 最後の桁の繰り上がりを考慮
    if ($carryOver > 0) {
        $reversedSumDigit[] = $carryOver;
    }

    // 再び逆順にすれば答えになる
    return implode(array_reverse($reversedSumDigit));
}
```

implodeは配列要素を文字列により連結する
[PHP: implode \- Manual](https://www.php.net/manual/ja/function.implode.php)

int型は最大19桁

```php
var_dump(PHP_INT_MAX); // int(9223372036854775807)
```

なので、文字数として受け取る。

```php
function addBigInt(string $a, string $b): string
{
    return '';
}
```

筆算は1の位から順に行うので、受け取った文字列を逆順で配列に収める

```php
// 自然数を受け取る
$reversedDigit1 = array_reverse(str_split($a));
$reversedDigit2 = array_reverse(str_split($b));
```

逆数に収めておくと、配列のインデックス番号が10の累乗部分そのものになる

```php
// 各位の足し算をする
$carryOver = 0; // 繰り上がりの数字 (2 つの数の足し算なら必ず 0 or 1)
foreach ($reversedSumDigit as $power => $digit) {
    // 直接要素をいじりたいので， $reversedSumDigit[$power] を変数化しない
    $reversedSumDigit[$power] += $carryOver;
    $carryOver = 0;
    $reversedSumDigit[$power] += $reversedDigit1[$power] + $reversedDigit2[$power];
    if ($reversedSumDigit[$power] >= 10) {
        $carryOver += floor($reversedSumDigit[$power] / 10);
        $reversedSumDigit[$power] %= 10;
    }
}

// 最後の桁の繰り上がりを考慮
if ($carryOver > 0) {
    $reversedSumDigit[] = $carryOver;
}
```

数値が逆順なので、元に戻す

```Php
// 再び逆順にすれば答えになる
return implode(array_reverse($reversedSumDigit));
```

array_reverse要素を逆順にした配列を返す。
[PHP: array\_reverse \- Manual](https://www.php.net/manual/ja/function.array-reverse.php)