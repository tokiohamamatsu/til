# 2020-01

## 06

### [動くスプレッド構文 \- Qiita](https://qiita.com/hoo-chan/items/dfe10728d05f83bee41d)

`[...iterableA,...iterableB]`を評価する処理

```js
const iterableA = [A1, A2, A3];
const iterableB = [B1, B2];
const result = [];

const iteratorA = iterableA[Symbol.iterator]();
while (1) {
  const iteratorResult = iteratorA.next();
  if (iteratorResult.done) {
    break;
  }
  result.push(iteratorResult.value);
}

const iteratorB = iterableB[Symbol.iterator]();
while (1) {
  const iteratorResult = iteratorB.next();
  if (iteratorResult.done) {
    break;
  }
  result.push(iteratorResult.value);
}
// result
// {"value":"A1","done":false}
// {"value":"A2","done":false}
// {"value":"A3","done":false}
// {"done":true}
// {"value":"B1","done":false}
// {"value":"B2","done":false}
// {"done":true}
// ["A1","A2","A3","B1","B2"]

```

わからなかったこと

- Symbol.iterator
- .next()
- .done

## 07

### [JavaScript の イテレータ を極める！ \- Qiita](https://qiita.com/kura07/items/cf168a7ea20e8c2554c6)

イテレータとは、順番にイテレータリザルトを取り出すことのできるオブジェクト

イテレータは`.next()`メソッドを持ち、それを実行するとイテレータリザルトを返す

```js
var iterator = {}; // イテレータ
iterator.next = function(){
    var iteratorResult = { value: 42, done: false }; // イテレータリザルト
    return iteratorResult;
};
```

イテレータオブジェクトはオブジェクトであり`.value`と`.done`プロパティを持つ

- `.value`プロパティはイテレータから取り出した値
- `.done`プロパティはイテレータから値を順番に取り出し終えたかどうかの真偽値

イテレータを持つオブジェクトのことをイテラブル(iterable)という

イテラブルは`[Symbol.iterator]()`メソッドを実行するとイテレータを返す

```js
var iterator = {}; // イテレータ
iterator.next = function(){
    var iteratorResult = { value: 42, done: false }; // イテレータリザルト
    return iteratorResult;
};

var obj = {}; // イテラブルなオブジェクト
obj[Symbol.iterator] = function(){
    return iterator;
};
```

例

イテラブルなオブジェクトを作る

1~10の数を順番に取り出せるイテレータを持つイテラブルを作る

```js
var obj = {}; // イテラブルなオブジェクト
obj[Symbol.iterator] = function(){
    var iterator = {}; // イテレータ
    var count = 1;
    iterator.next = function(){
        var iteratorResult = (count <= 10)
            ? { value: count++,   done: false }
            : { value: undefined, done: true };
        return iteratorResult; // イテレータリザルト
    };
    return iterator;
};

var iterator = obj[Symbol.iterator](); // イテラブルなオブジェクトからイテレータを取得する
var iteratorResult;
while(true){
    iteratorResult = iterator.next(); // 順番に値を取りだす
    if(iteratorResult.done) break; // 取り出し終えたなら、break
    console.log(iteratorResult.value); // 値をコンソールに出力
}
```

現在の値が`count`で保持され、`.next()`を実行するごとにカウントアップし、10を超えたら、`.done`をtrueにし値を順番に取り出し終えたことを示す

イテレータから値を取り出す構文に`for(v of iterable)`がある

```js
var obj = {}; // イテラブルなオブジェクト
obj[Symbol.iterator] = function(){
    var iterator = {}; // イテレータ
    var count = 1;
    iterator.next = function(){
        var iteratorResult = (count <= 10)
            ? { value: count++,   done: false }
            : { value: undefined, done: true };
        return iteratorResult; // イテレータリザルト
    };
    return iterator;
};

for(var v of obj) console.log(v);
```

`for(v of iterable)`は以下の処理を順に行う

1. `iterator=iterable[Symbol.iterator]()`を実行し、イテレータを取得する
2. `iteratorResult=iterator.next()`を実行し、イテレータリザルトを取得する
3. `iteratorResult.done==true`なら取り出し終えたので終了、そうでないなら2に戻る