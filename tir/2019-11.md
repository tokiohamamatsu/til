# 2019-11

## 01

### [phpの圧縮について \- Qiita](https://qiita.com/sota/items/07e8ad480556c9a43d77)

例

圧縮前

```php
    protected function _getUserList() {

        $userList = array();

        $key = __METHOD__;
        $cacheRes = Cache::read($key);
        if ( $cacheRes ) {
            $userList = $cacheRes;
            return $userList;
        }

        $userList = UserDb::selectUserList()
        $ret = Cache::save($key, $userList , 60);
        return $userList;
    }

# 保存内容は利用者に任せているのでバカでかいarrayとかが保存されがち
```

圧縮後

```php
   protected function _getUserList() {

        $userList = array();

        $key = __METHOD__;
        $cacheRes = Cache::read($key);
        if ( $cacheRes ) {
            $userList = json_decode(gzuncompress($cacheRes), true);
            return $userList;
        }

        $userList = UserDb::selectUserList()
        $comp = gzcompress(json_encode($userList))
        $ret = Cache::save($key, $comp, 60);
        return $userList;
    }
```

gzuncompressとは

圧縮された文字列を解凍する
[PHP: gzuncompress \- Manual](https://www.php.net/manual/ja/function.gzuncompress.php)


gzcompressとは

文字列を圧縮する

[PHP: gzcompress \- Manual](https://www.php.net/manual/ja/function.gzcompress.php)


圧縮と解凍はこうやるのか