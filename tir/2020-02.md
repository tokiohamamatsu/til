# 2020-02

## 03

### [envファイルとはなんだろう。 \- Qiita](https://qiita.com/harutakaoka522/items/e0abddfd0311eb4fb32b)

laravelのenvファイルはUNIX系OSで使えるコマンド`env`の本体ファイル、シェル起動時に読み込まれ、リポジトリにコミットされない。環境ごとに変更したい情報をまとめておくファイル。

開発環境、本番環境の切り替えやDBの接続情報の変更など

envはconfig経由で呼び出す

例

```php
'username' => env('DB_USERNAME', 'doruji'),
```

config/app
```php
return [
    'hoge_env' => env('hoho'),
];
```

Controller

```php
$hoge = config('app.hoge_env');
dd($hoge);
```

※ envファイルはコントローラやモデルから直接読み込んではいけない

envファイルは`Illuminate\Foundation\Bootstrap\LoadEnvironmentVariable`の`bootstrap()`で読み込まれ、キャッシュがある場合は読み込まれない

envファイルの中身

``` php
APP_NAME： 開発しているサイト名
APP_ENV： 開発しているサイトの実行環境名(local/staging/production)
APP_KEY： 暗号化に使われるキー
APP_DEBUG： デバッグの表示設定(デフォルトはtrue)
APP_URL： サイトのURL
LOG_CHANNEL： ログ情報の設定
DB_CONNECTION：利用するデータベースの種類 (mysql/pgsql/sqlite)
DB_HOST：データベースのホスト
DB_PORT：データベースが利用するポート番号
DB_DATABASE：利用するデータベース名
DB_USERNAME：利用するデータベース名にアクセスするユーザー名
DB_PASSWORD：利用するデータベース名にアクセスするパスワード
```

configなどを深堀りしたほうがいいようだ。

## 04

### [jQueryの「配列内に1つでも値があればtrueを返す」でハマった \- Qiita](https://qiita.com/wakanaction/items/306394b12da492a9ac27)

```js
  /**
   * 配列を受け取り、1つでも値が入っていればtrueを返す
   * 間違い版
   */
  "SampleArrayCheck": function(targetArray) {
    $.each(targetArray, function(index, answer){
      if(answer){
        return true;
      }
    });
    return false;
  },
```

上記のコードは配列をeach()で回し、条件に当てはまったらtrueを返し、ループを抜けるコードなのだが、うまくいかない。

原因としては、returnしているが、毎回のfunctionを抜けているだけでeach()を抜けていないらしい。

変数に格納する形に変更するとうまくいく。

```js
  /**
   * 配列を受け取り、1つでも値が入っていればtrueを返す
   * 修正版
   */
  "SampleArrayCheck": function(targetArray) {
    // 関数のスコープ内でステータス管理の変数を用意する
    let result = false;

    $.each(targetArray,function(index, answer){
      if(answer){
        // trueを代入するだけにする
        result = true;
      }
    });

    // trueでもfalseでもここで返る
    return result;
  },
```

なぜ、returnしてもeach()から抜けないのか?

`return true`はeach()内のfunctionに掛かっているから

## 05

### [【jQuery】リロードしないとプレビュー表示できない→turbolinksが原因 \- Qiita](https://qiita.com/kodaii/items/dcb60516d3387a357d4b)

jQueryを用いてプレビュー表示機能を実装したが、うまくいかず、リロードを行うとうまくいかない事例

```js
  $(function(){
    fileField = $('#file')
    #選択された画像を取得し表示
    fileField.on('change', fileField, function(e) {
      var file = e.target.files[0]
      var reader = new FileReader(),
      $preview = $("#img-field");
      reader.onload = (function(file) {
        return function(e) {
          $preview.empty();
          $preview.append($('<img>').attr({
            src: e.target.result,
            width: "100%",
            class: "preview",
            title: file.name
          }));
        };
      })(file);
      reader.readAsDataURL(file);
    });
  });
```

原因としては、`turbolinks`によりjsが機能しないらしい

解決方法としては下記のコードの中に入れる

```js
$(document).on('turbolinks:load', function() {
  #上記のコードをここに挟む
});
```

`turbolinks`とはなんだ？

参考にした記事によると、Webアプリケーションを素早く表示させることができるgemのこと。

gemはRuby用のパッケージ管理ツールらしい
[Ruby on Rails 初心者必見！パッケージ管理ツール『gem』を徹底解説 \| CodeCampus](https://blog.codecamp.jp/rails-gem)

なぜ、webアプリケーションを素早く表示させるものが、jsが機能しない原因になるのか?

## 06

### [LaravelでAWS認証エラーが起きる？恐らくそれはconfig\_cacheの影響です \- Qiita](https://qiita.com/yokozawa/items/975a466ff9d9754f30c9)

下記は、laravelでAWSソリューションを使っているとおこるエラー

```php
{
  "code": "400",
  "message": "Client error: `GET http://169.254.xxx.xxx/latest/meta-data/iam/security-credentials/` resulted in a `404 Not Found` response:\n<?xml version=\"1.0\" encoding=\"iso-8859-1\"?>\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\n\t\"http://www. (truncated...)\n",
  "exception": "GuzzleHttp\\Exception\\ClientException"
}
```

内容としてはAWSの認証情報であるCredentialsがエラーとのこと

envファイルにAWS_ACCESS_KEY_IDとAWS_SELECT_ACCESS_KEYに記述している場合は原因として、configファイルがキャッシュされており、正常にAWSのCredentialsが読み込まれずエラーが返る。

`php artisan config:clear`を叩けばこの問題は解消されると思われる。

AWSについて

[AWSにおける認証の仕組みを活用する【第7回】 \| IT Leaders](https://it.impressbm.co.jp/articles/-/14589)

## 10

### [もう2020年！いい加減、React勉強し始めてみた \- Qiita](https://qiita.com/10mi8o/items/76bad290d2b2557748c4)

Reactとは

UIを構築するための、宣言型jsライブラリのこと

Reactは状態を保つようなインタラクティブなUIを作成しやすいように設計されている。

コンポーネント単位での実装が容易のため、再利用正が高い

JSX はReactでHTMLを出力するための独自構文で、JSの機能を備えており、埋め込まれた値をレンダリングする前に、エスケープするため、インジェクション攻撃を防ぐことができる。

Reactは、JSXでの、記述を強制しているわけではない。

JSXは子要素を定義でき、値を埋め込むこともできる

```js
// 子要素の定義
const elem = (
    <>
　　　　　<section className='head'>
        　<h1>Study React!</h1>
        <h2>Hello.</h2>
          </section>
        <section className='body'>
          <h1>
            Roadmap
          </h1>
        </section>
    </>
)
```

```js
// JSXに値を埋め込む
let title = 'Study React!';
let greeting = 'Hello';
const heading_s = { color: 'red', borderBottom: '1px solid #DDD' }

let elem = (
    <>
        //属性の値にも利用できることに注目
        <h1 style={ heading_s }>{ title }</h1>
        <h2>{ greeting }</h2>
    </>   
)
```

JSXはエレメントを定義する際、`<div>`か`<>`で囲む必要がある。

renderメソッドで、描画できるのは一つのエレメントだけというルールがある。

コンポーネントは、関数コンポーネントとクラスコンポーネントの二種類がある。

```js
import React, { Component } from 'react';

//関数コンポーネント
function StudyReact(props) {
    return <h1>During study...</h1>
}

//クラスコンポーネント
class StudyReact extends Component {

    constructor(props) {
        super(props);
        this.state = {
            status: 'During study...'
        }
    }

    render() {
        return <h1>{this.state.status}</h1>
    }
}
```