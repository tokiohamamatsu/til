# バリデーションについて

## うまくいかなかったこと

[バリデーション 5\.5 Laravel](https://readouble.com/laravel/5.5/ja/validation.html)に書いてあるクイックスタートをためしたがバリデーションを通ったら真っ白な画面になった

### プログラム
TestController.php
```php
<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use App\Http\Controllers\Controller;

class TestController extends Controller
{
    public function test()
    {
        return view('post.test');
    }
    
    public function view(Request $request)
    {
        return redirect('post.test');
    }
    
    public function validation(Request $request)
    {
        $validator=$request->validate([
            'title'=>'required|string|max:40',
            'body'=>'required',
        ]);
    }
}
```

Web.php
```php
    Route::get('post/test','TestController@test');
    Route::post('post','TestController@view');
    Route::post('post','TestController@validation');
```
## 原因
バリデーションに戻り値を設定していないから
## 修正
ルートを使うのをやめて$thisを使いバリデーションを行うことにした。

### プログラム
TestController.php
```php
<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use App\Http\Controllers\Controller;

class TestController extends Controller
{
    public function test()
    {
        return view('post.test');
    }
    
    public function view(Request $request)
    {
        $vali=$this->validation($request);
        if($vali==true){
            return redirect('post.test');
        }
        
    }
    
    public function validation(Request $request)
    {
        $validator=$request->validate([
            'title'=>'required|string|max:40',
            'body'=>'required',
        ]);
        return true;
    }
}
```
Web.php
```php
    Route::get('post/test','TestController@test');
    Route::post('post','TestController@view');
```
### 参考
[Laravelのvalidationメソッドでバリデーションを実装する入門編（日本語エラーメッセージ付き）](https://www.ritolab.com/entry/40)


## エラーメッセージの出し方
ビューに下記を追加する

test.blade.php
```php
@if ($errors->any())
    <div class="alert alert-danger">
        <ul>
            @foreach ($errors->all() as $error)
                <li>{{ $error }}</li>
            @endforeach
        </ul>
    </div>
@endif
```

## エラーメッセージを日本語にする方法
1. config/appの70行目付近にenの文字があるのでそれをjaにする
2. resources/langのenフォルダーをコピーする
3. コピーしたフォルダをlangにペーストしてフォルダ名をjaに変更
4. jaフォルダーの中にあるvalidationファイルの中にある適したエラーメッセージを書き換える

### 参考
[Laravel5\.3 で超ラクにバリデーションしてエラーメッセージを変更する \- Qiita](https://qiita.com/komatzz/items/422bcba9847ca3a79fe9)
