# VisualStudioデバック方法

開発者の意図通りコードが動くことは殆どなく、意図しない動きをする場合もある。その場合、次の行動は原因をさがすことだが、ただコードを見るのではなく。デバッグ用のツール(デバッカー)を使用したほうが効率がいい。

しかし、デバッカーはバグを見つけるものではない。デバッグとはコードを1ステップずつ実行し、プログラミングが間違っている箇所を正確にすること。デバッグツールを使えば、プログラムを実行しながら一時的に変更することが出来る。

コードを修正するには先に直面している問題を明確にすることが大切で、コードで何を行おうとしたか。代わりにどのようなことが発生したかを明確にする。エラー(例外)とはコードを実行すると発生する予期しないイベントであり、通常は何らかの種類のエラーで、デバッガーでコードをスキップ実行し、変数に対する全ての変更を個別に調べて、正しくない値が割り当てれるタイミングと方法を明確にできる。

バグまたはエラーを調査する前に、特定の結果を想定するに至った前提を考える。隠れた前提や、未知の前提があると、デバッガーで原因を究明しようとしても、問題の識別が妨げられる事がある。

前提としては
- 適切なAPIを使用しているか
- APIの使い方を間違ってはいないか
- コードにタイプミスがないか・・・単純なスペルミスは発見するのが難しい
- 他のコードを変更し、それが発生している。問題に関係ないか
- オブジェクトまたは変数に含まれると想定した特定の値が、実際に発生する値と異なっていないか
- コードの意図がわかっているか

等が挙げられる。

前提を確認することで、コード内の問題の発見に要する時間、解決する時間を短縮できる。

コードを作成するには小さく動作するコードから始めるようにする。場合によって、実現しようとしてる中心的タスクを示す。コードの小さなまとまりから始めたほうが、大規模または複雑なコードのセットの修正が容易になる。その後、段階的にコードを変更または、追加し、各ポイントでエラーをテストをすることが出来る。

アプリを実行した場合エラーや不正な結果はコードが実行された後でしか表示されず、プログラムが理由を示すことなく予期せず終了することもある。

デバックモード(デバッガー内でアプリを実行すること)で実行するとプログラムの実行中に発生する全てのことをデバッガーが能動的に監視する。また、いつでもアプリを一時停止して状態を調べた後、コードを1行ずつステップ実行して発生する全てのことを確認できる。

VisualStudioでデバックモードを使うにはF5キーかデバッグツールバーからデバッグの開始を選択する、もしくはデバッグの開始ボタンを押すことで使用できる。例外が発生した場合、VisealStudioの例外ヘルパーによって、例外が発生した地点に移動し、有用な情報が提供される。

例外が発生しなかった場合は、デバッガーでブレークポイントを使用し、コードをより詳しく調べる事ができる。ブレークポイントは、VisualStudioが実行中のコードを一時停止する場所を示す。これにより、変数の値、メモリの動作、メモリの動作、コード実行のシーケンスなどを確認できる。
VisualStudioではコード行の左にある余白をクリックするか、行にカーソルを置いて、F9を押すことで、ブレークポイントを設置出来る。

問題が見つかったらデバッガーとF10やF11などのステップコマンドを使用し、問題のあるコードの領域を探す。しかし、コードの領域を特定するのは困難な場合は、問題が発生する前に実行されるコードにブレークポイントを設定した後、問題の兆候が現れるまでステップコマンドを使用する。

デバッガーツールはコードの意図がわかっている場合にのみ、自動的にバグを発見でき、開発者がその意図を表現した場合にのみ、ツールはコードの意図を認識できる。